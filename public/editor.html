<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>CodeQuest Editor - Professional Code Editor</title>
    <link rel="stylesheet" href="styles.css" />
    <link rel="stylesheet" href="animations.css" />
    <link rel="stylesheet" href="editor-styles.css" />
    <link rel="stylesheet" href="game-editor-styles.css" />
    <link rel="stylesheet" href="ai-assistant.css" />
    <link rel="stylesheet" href="enhanced-editor-styles.css" />
    <link
      href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;500;600;700&family=Inter:wght@400;500;600;700&display=swap"
      rel="stylesheet"
    />
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"
    />
  </head>
  <body>
    <div class="bg-animation"></div>

    <!-- Navigation -->
    <nav id="navbar">
      <div class="nav-container">
        <a href="index.html" class="logo">âš¡CodeQuest</a>
        <div class="hamburger" id="hamburger">
          <span></span>
          <span></span>
          <span></span>
        </div>
        <div class="nav-links" id="navLinks">
          <a href="index.html" class="nav-link">Home</a>
          <a href="learn.html" class="nav-link">Learn</a>
          <a href="editor.html" class="nav-link active">Code Editor</a>
          <a href="challenges.html" class="nav-link">Challenges</a>
          <a href="games.html" class="nav-link">Games</a>
          <a href="leaderboard.html" class="nav-link">Leaderboard</a>
          <a href="about.html" class="nav-link">About</a>
          <span id="authButtons">
            <button class="btn btn-secondary" onclick="showLogin()">
              Login
            </button>
            <button class="btn btn-primary" onclick="showSignup()">
              Sign Up
            </button>
          </span>
          <span id="userMenu" style="display: none">
            <span class="nav-link" id="userGreeting">Welcome!</span>
            <a href="dashboard.html" class="btn btn-secondary">Dashboard</a>
            <button class="btn btn-danger" onclick="logout()">Logout</button>
          </span>
        </div>
      </div>
    </nav>

    <!-- Enhanced Editor Container -->
    <div class="editor-container">
      <!-- Enhanced Header Section -->
      <header class="editor-header">
        <div class="challenge-info">
          <div class="challenge-main">
            <h1 class="challenge-title" id="challengeTitle">Code Editor</h1>
            <div class="challenge-meta-display">
              <span class="challenge-badge difficulty" id="challengeDifficulty"
                >Free Play</span
              >
              <span class="challenge-badge xp" id="challengeXP">+0 XP</span>
            </div>
            <div class="challenge-description" id="challengeDescription">
              <div id="defaultDescription">
                <p>
                  Welcome to the CodeQuest Editor! Use this space to practice
                  coding, experiment with ideas, or work on your own projects.
                </p>
                <p>
                  You can switch between HTML, CSS, and JavaScript tabs to build
                  complete web pages.
                </p>
                <div class="challenge-actions">
                  <button
                    class="btn btn-primary"
                    onclick="window.codeEditor && window.codeEditor.loadChallengeList()"
                  >
                    <i class="fas fa-list"></i>
                    Browse Challenges
                  </button>
                  <button
                    class="btn btn-secondary"
                    onclick="window.codeEditor && window.codeEditor.loadRandomChallenge()"
                  >
                    <i class="fas fa-random"></i>
                    Random Challenge
                  </button>
                </div>
              </div>
              <div id="challengeDescriptionContent" style="display: none">
                <!-- Challenge description will be populated here -->
              </div>
            </div>
          </div>
          <div class="challenge-meta">
            <button
              class="challenge-badge difficulty mode-btn active"
              id="freePlayBtn"
              data-mode="free-play"
            >
              <i class="fas fa-play"></i>
              Free Play
            </button>
            <button
              class="btn btn-secondary"
              onclick="window.codeEditor && window.codeEditor.loadRandomChallenge()"
            >
              <i class="fas fa-graduation-cap"></i>
              Practice Mode
            </button>
          </div>
        </div>
      </header>

      <!-- Enhanced Action Buttons -->
      <div class="action-buttons">
        <button id="runTestsBtn" class="btn btn-primary">
          <i class="fas fa-play"></i>
          Run Tests
        </button>
        <button id="resetCodeBtn" class="btn btn-secondary">
          <i class="fas fa-undo"></i>
          Reset Code
        </button>
        <button id="submitBtn" class="btn btn-success">
          <i class="fas fa-check"></i>
          Submit
        </button>
      </div>

      <!-- Game Instructions Panel -->
      <div id="gameInstructions" class="game-panel" style="display: none">
        <div class="panel-header">
          <h3>
            <i class="fas fa-gamepad"></i>
            <span id="gameTitle">Game Instructions</span>
          </h3>
          <div class="game-meta">
            <span class="game-timer"
              >Time: <span id="timeDisplay">00:00</span></span
            >
            <span class="game-difficulty" id="gameDifficulty">Easy</span>
          </div>
        </div>
        <div class="panel-content">
          <div id="gameDescription" class="game-description">
            <!-- Game description will be populated here -->
          </div>
          <div id="gameObjectives" class="game-objectives">
            <h4><i class="fas fa-target"></i> Objectives:</h4>
            <ul id="objectivesList">
              <!-- Objectives will be populated here -->
            </ul>
          </div>
          <div class="game-actions">
            <button id="submitGameBtn" class="btn btn-primary">
              <i class="fas fa-trophy"></i> Submit Game
            </button>
            <button id="resetGameBtn" class="btn btn-secondary">
              <i class="fas fa-refresh"></i> Reset
            </button>
          </div>
        </div>
      </div>

      <!-- Challenge Instructions Panel -->
      <div
        id="challengeInstructions"
        class="challenge-panel"
        style="display: none"
      >
        <div class="panel-header">
          <h3>
            <i class="fas fa-trophy"></i>
            <span id="challengeTitlePanel">Challenge</span>
          </h3>
          <div class="challenge-meta">
            <span
              class="challenge-difficulty-badge"
              id="challengeDifficultyPanel"
              >Medium</span
            >
            <span class="challenge-xp-badge" id="challengeXPPanel">+50 XP</span>
          </div>
        </div>
        <div class="panel-content">
          <div id="challengeDescriptionPanel" class="challenge-description">
            <!-- Challenge description will be populated here -->
          </div>
          <div id="challengeRequirements" class="challenge-requirements">
            <h4><i class="fas fa-list-check"></i> Requirements:</h4>
            <ul id="testStatements">
              <!-- Requirements will be populated here -->
            </ul>
          </div>
          <div class="challenge-actions">
            <button id="submitChallengeBtn" class="btn btn-primary">
              <i class="fas fa-check"></i> Submit Challenge
            </button>
            <button id="runTestsBtn" class="btn btn-secondary">
              <i class="fas fa-play"></i> Run Tests
            </button>
          </div>
        </div>
      </div>

      <!-- Legacy Challenge Test Statements (for compatibility) -->
      <div id="challengeTests" class="challenge-tests" style="display: none">
        <div class="tests-header">
          <h3><i class="fas fa-list-check"></i> Challenge Requirements</h3>
        </div>
        <div id="testStatementsLegacy" class="test-statements">
          <!-- Test statements will be populated here -->
        </div>
      </div>

      <!-- Enhanced Tab Container -->
      <div class="tab-container">
        <div class="tab-header">
          <button class="tab-btn active" data-tab="html">
            <i class="tab-icon fas fa-globe"></i>
            HTML
          </button>
          <button class="tab-btn" data-tab="css">
            <i class="tab-icon fas fa-palette"></i>
            CSS
          </button>
          <button class="tab-btn" data-tab="js">
            <i class="tab-icon fas fa-bolt"></i>
            JavaScript
          </button>
          <button class="tab-btn" data-tab="preview">
            <i class="tab-icon fas fa-eye"></i>
            Preview
          </button>
        </div>

        <!-- Enhanced HTML Editor Pane -->
        <div id="html-editor" class="editor-pane active">
          <div class="editor-header">
            <span>HTML Editor</span>
            <div class="editor-actions">
              <button
                class="btn-icon"
                onclick="window.codeEditor && window.codeEditor.formatCode('html')"
                title="Format HTML"
              >
                <i class="fas fa-magic"></i>
              </button>
            </div>
          </div>
          <div id="html-monaco" class="monaco-editor">
            <!-- Will be replaced with textarea -->
          </div>
        </div>

        <!-- Enhanced CSS Editor Pane -->
        <div id="css-editor" class="editor-pane">
          <div class="editor-header">
            <span>CSS Editor</span>
            <div class="editor-actions">
              <button
                class="btn-icon"
                onclick="window.codeEditor && window.codeEditor.formatCode('css')"
                title="Format CSS"
              >
                <i class="fas fa-magic"></i>
              </button>
            </div>
          </div>
          <div id="css-monaco" class="monaco-editor">
            <!-- Will be replaced with textarea -->
          </div>
        </div>

        <!-- Enhanced JavaScript Editor Pane -->
        <div id="js-editor" class="editor-pane">
          <div class="editor-header">
            <span>JavaScript Editor</span>
            <div class="editor-actions">
              <button
                class="btn-icon"
                onclick="window.codeEditor && window.codeEditor.formatCode('js')"
                title="Format JavaScript"
              >
                <i class="fas fa-magic"></i>
              </button>
            </div>
          </div>
          <div id="js-monaco" class="monaco-editor">
            <!-- Will be replaced with textarea -->
          </div>
        </div>

        <!-- Enhanced Preview Pane -->
        <div id="preview-editor" class="editor-pane">
          <div class="editor-header">
            <span>Live Preview</span>
            <div class="preview-actions">
              <button
                class="btn-icon"
                onclick="window.codeEditor && window.codeEditor.updatePreview()"
                title="Refresh Preview"
              >
                <i class="fas fa-sync-alt"></i>
              </button>
              <button
                class="btn-icon"
                onclick="window.codeEditor && window.codeEditor.toggleFullscreen()"
                title="Fullscreen"
              >
                <i class="fas fa-expand"></i>
              </button>
            </div>
          </div>
          <div class="preview-container">
            <iframe id="preview-frame" sandbox="allow-scripts"></iframe>
          </div>
        </div>
      </div>

      <!-- Enhanced Test Results -->
      <div class="test-results">
        <div class="test-header">
          <h3 class="test-title">Test Results</h3>
          <span class="status-indicator waiting" id="testStatus"
            >WAITING...</span
          >
        </div>
        <div class="test-content" id="testResults">
          <div class="test-placeholder">
            <p>Click "Run Tests" to see your results</p>
          </div>
        </div>
      </div>

      <!-- Game Results Panel -->
      <div
        id="gameResults"
        class="results-panel game-results"
        style="display: none"
      >
        <div class="results-header">
          <h3><i class="fas fa-trophy"></i> Game Results</h3>
          <button
            class="close-btn"
            onclick="this.parentElement.parentElement.style.display='none'"
          >
            <i class="fas fa-times"></i>
          </button>
        </div>
        <div class="results-content" id="gameResultsContent">
          <!-- Game results will be populated here -->
        </div>
      </div>

      <!-- Challenge Results Panel -->
      <div
        id="challengeResults"
        class="results-panel challenge-results"
        style="display: none"
      >
        <div class="results-header">
          <h3><i class="fas fa-check-circle"></i> Challenge Results</h3>
          <button
            class="close-btn"
            onclick="this.parentElement.parentElement.style.display='none'"
          >
            <i class="fas fa-times"></i>
          </button>
        </div>
        <div class="results-content" id="challengeResultsContent">
          <!-- Challenge results will be populated here -->
        </div>
      </div>
    </div>

    <!-- AI Assistant will be automatically injected by ai-assistant.js -->

    <!-- Enhanced Login Modal -->
    <div id="loginModal" class="modal">
      <div class="modal-content">
        <div class="modal-header">
          <h2><i class="fas fa-sign-in-alt"></i> Login</h2>
          <button class="modal-close">&times;</button>
        </div>
        <div class="modal-body">
          <form id="loginForm">
            <div class="form-group">
              <label for="loginEmail">Email</label>
              <input
                type="email"
                id="loginEmail"
                required
                placeholder="Enter your email"
              />
            </div>
            <div class="form-group">
              <label for="loginPassword">Password</label>
              <input
                type="password"
                id="loginPassword"
                required
                placeholder="Enter your password"
              />
            </div>
            <button type="submit" class="btn btn-primary btn-block">
              Login
            </button>
          </form>
          <div class="form-footer">
            <p>
              Don't have an account? <a href="#" id="showSignupLink">Sign up</a>
            </p>
          </div>
        </div>
      </div>
    </div>

    <!-- Enhanced Signup Modal -->
    <div id="signupModal" class="modal">
      <div class="modal-content">
        <div class="modal-header">
          <h2><i class="fas fa-user-plus"></i> Sign Up</h2>
          <button class="modal-close">&times;</button>
        </div>
        <div class="modal-body">
          <form id="signupForm">
            <div class="form-group">
              <label for="signupUsername">Username</label>
              <input
                type="text"
                id="signupUsername"
                required
                placeholder="Choose a username"
              />
            </div>
            <div class="form-group">
              <label for="signupEmail">Email</label>
              <input
                type="email"
                id="signupEmail"
                required
                placeholder="Enter your email"
              />
            </div>
            <div class="form-group">
              <label for="signupPassword">Password</label>
              <input
                type="password"
                id="signupPassword"
                required
                placeholder="Create a password"
              />
            </div>
            <button type="submit" class="btn btn-primary btn-block">
              Create Account
            </button>
          </form>
          <div class="form-footer">
            <p>
              Already have an account? <a href="#" id="showLoginLink">Login</a>
            </p>
          </div>
        </div>
      </div>
    </div>

    <!-- Scripts -->
    <script src="auth.js"></script>
    <script src="ai-assistant.js"></script>
    <script src="main.js"></script>
    <script src="instruction-loader.js"></script>
    <script src="editor.js"></script>
  </body>
</html>
