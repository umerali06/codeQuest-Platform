<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Test Editor Syntax Fix</title>
    <link rel="stylesheet" href="public/styles.css" />
    <link rel="stylesheet" href="public/game-editor-styles.css" />
  </head>
  <body>
    <div class="container">
      <h1>Editor Syntax Fix Test</h1>

      <div
        id="status"
        style="padding: 20px; margin: 20px 0; border-radius: 5px"
      >
        <h3>Testing Status:</h3>
        <div id="test-results"></div>
      </div>

      <!-- Game Instructions Panel -->
      <div id="gameInstructions" class="game-panel" style="display: none">
        <h3 id="gameTitle">Game Title</h3>
        <div id="gameDescription">Game description will appear here</div>
        <div id="gameObjectives">
          <h4>Objectives:</h4>
          <ul id="objectivesList"></ul>
        </div>
        <div id="gameTimer">Time: <span id="timeDisplay">00:00</span></div>
        <button id="submitGameBtn" class="btn btn-primary">
          Submit Solution
        </button>
      </div>

      <!-- Editor Container -->
      <div class="editor-container">
        <div class="editor-header">
          <h2 id="challengeTitle">Code Editor</h2>
        </div>
        <div id="editor" style="height: 400px; border: 1px solid #ccc"></div>
      </div>

      <!-- Results Panel -->
      <div id="gameResults" class="game-panel" style="display: none">
        <h3>Game Results</h3>
        <div id="resultsContent"></div>
      </div>
    </div>

    <!-- Load Monaco Editor -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/monaco-editor/0.34.1/min/vs/loader.min.js"></script>

    <script>
      // Test the editor initialization
      function runTests() {
        const results = document.getElementById("test-results");
        const status = document.getElementById("status");

        try {
          // Test 1: Check if editor.js loads without syntax errors
          results.innerHTML +=
            "<p>‚úÖ Test 1: editor.js loaded without syntax errors</p>";

          // Test 2: Check if CodeEditor class exists
          if (typeof CodeEditor !== "undefined") {
            results.innerHTML +=
              "<p>‚úÖ Test 2: CodeEditor class is defined</p>";
          } else {
            results.innerHTML +=
              "<p>‚ùå Test 2: CodeEditor class is not defined</p>";
          }

          // Test 3: Try to initialize editor
          const editor = new CodeEditor();
          results.innerHTML +=
            "<p>‚úÖ Test 3: CodeEditor instance created successfully</p>";

          // Test 4: Check if game methods exist
          if (typeof editor.checkForGame === "function") {
            results.innerHTML += "<p>‚úÖ Test 4: checkForGame method exists</p>";
          } else {
            results.innerHTML +=
              "<p>‚ùå Test 4: checkForGame method missing</p>";
          }

          if (typeof editor.loadGameInstructions === "function") {
            results.innerHTML +=
              "<p>‚úÖ Test 5: loadGameInstructions method exists</p>";
          } else {
            results.innerHTML +=
              "<p>‚ùå Test 5: loadGameInstructions method missing</p>";
          }

          if (typeof editor.setupGameMode === "function") {
            results.innerHTML +=
              "<p>‚úÖ Test 6: setupGameMode method exists</p>";
          } else {
            results.innerHTML +=
              "<p>‚ùå Test 6: setupGameMode method missing</p>";
          }

          status.style.backgroundColor = "#d4edda";
          status.style.color = "#155724";
          results.innerHTML +=
            "<p><strong>üéâ All tests completed! Editor syntax is fixed.</strong></p>";
        } catch (error) {
          status.style.backgroundColor = "#f8d7da";
          status.style.color = "#721c24";
          results.innerHTML += `<p>‚ùå Error during testing: ${error.message}</p>`;
          console.error("Test error:", error);
        }
      }

      // Load editor.js and run tests
      const script = document.createElement("script");
      script.src = "public/editor.js";
      script.onload = () => {
        console.log("editor.js loaded successfully");
        setTimeout(runTests, 100); // Small delay to ensure everything is initialized
      };
      script.onerror = (error) => {
        const results = document.getElementById("test-results");
        const status = document.getElementById("status");
        status.style.backgroundColor = "#f8d7da";
        status.style.color = "#721c24";
        results.innerHTML =
          "<p>‚ùå Failed to load editor.js - syntax error still exists</p>";
        console.error("Failed to load editor.js:", error);
      };
      document.head.appendChild(script);
    </script>
  </body>
</html>
